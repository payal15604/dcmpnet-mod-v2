# -*- coding: utf-8 -*-
"""Test_Train_Val_Split_No_Labels.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/github/Witcape/PSZ/blob/main/Test_Train_Val_Split_No_Labels.ipynb
"""

import os
import random
import shutil

def get_file_addresses(folder_path):
  return [os.path.join(folder_path, file) for file in os.listdir(folder_path) if os.path.isfile(os.path.join(folder_path, file))]

def split_dataset(addresses, train_ratio, seed = 42):
  random.seed(seed)
  total = len(addresses)
  train_end = int(total * train_ratio)

  train_split = addresses[:train_end]
  test_split = addresses[train_end:]
  return train_split, test_split

def save_splits(train_split, test_split, output_folder):
  train_dir = os.path.join(output_folder, "train")
  #val_dir = os.path.join(output_folder, "val")
  test_dir = os.path.join(output_folder, "test")

  os.makedirs(train_dir, exist_ok=True)
  os.makedirs(test_dir, exist_ok=True)

  def copy_files(file_list, target_dir):
    for file_path in file_list:
      shutil.copy(file_path, target_dir)

  copy_files(train_split, train_dir)
  copy_files(test_split, test_dir)

input_folder = "D:\dcmpnet\datasets\SOTS\SOTS\indoor\gt"
output_folder = "D:\dcmpnet\datasets\SOTS\SOTS\indoor\gt_final_data"

file_addresses = get_file_addresses(input_folder)
train, test = split_dataset(file_addresses, train_ratio=0.9, seed=42)
save_splits(train, test, output_folder)

print(f"Data split and saved to {output_folder}/train, {output_folder}/val, {output_folder}/test")

